Процедура НоваяКолонка(Таблица, ИмяКолонки, ТипКолонки, Выражение = """Тест""") Экспорт
	Таблица.Колонки.Добавить(ИмяКолонки, ?(ТипКолонки <> Неопределено, ТипКолонки, Тип("Строка")));
	Для Каждого СтрокаТаблицы Из Таблица Цикл
		СтрокаТаблицы[ИмяКолонки] = Вычислить(Выражение);
	КонецЦикла;
КонецПроцедуры

// Получает коллекцю элементов различающуюся по указанным св-вам
// для совпадающих эелементов, возвращается 1й элемент
// Параметры:
//	Таблица - таблица значений
//	ИменаКолонок - строка с именами полей, по которым устанавливается уникальность
// Возвращаемое значение:
//  Массив - массив значений
Функция Различные(Таблица, ИменаКолонок) Экспорт
	ТаблицаКлючей = Таблица.СкопироватьКолонки(ИменаКолонок);
	ТаблицаКлючей.Свернуть(ИменаКолонок);
		
	Результат = Новый Массив();
	Для Каждого СтрокаКлюч Из ТаблицаКлючей Цикл
		Ключ = Новый Структура(ИменаКолонок);
		ЗаполнитьЗначенияСвойств(Ключ, СтрокаКлюч);
		Значение = Таблица.НайтиСтроки(Ключ);
		Результат.Вставить(Ключ, Значение[0]);
	КонецЦикла;
	
	Возврат Результат;
КонецФункции

Функция Группировать(Таблица, ИменаКолонок) Экспорт
	ТаблицаКлючей = Таблица.СкопироватьКолонки(ИменаКолонок);
	ТаблицаКлючей.Свернуть(ИменаКолонок);
	
	Словарь = Новый Соответствие();
	Для Каждого СтрокаКлюч Из ТаблицаКлючей Цикл
		Ключ = Новый Структура(ИменаКолонок);
		ЗаполнитьЗначенияСвойств(Ключ, СтрокаКлюч);
		Значение = Таблица.НайтиСтроки(Ключ);
		Словарь.Вставить(Ключ, Значение);
	КонецЦикла;
	
	Возврат Словарь;
КонецФункции